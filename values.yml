## values.yml (default https://github.com/nextcloud/helm/blob/master/charts/nextcloud/values.yaml) for helm nextcloud helm chart
## https://github.com/nextcloud/helm
image:
  repository: schulcloud/schulcloud-nextcloud/production
  tag: latest
  pullPolicy: IfNotPresent

lifecycle:
  postStartCommand: ["/bin/sh", "-c", "/usr/nextcloud/configure.sh > /usr/nextcloud/configure_output"]

nextcloud:
  host: nextcloud.kube.home
  username: admin
  password: admin
  update: 0
  #containerPort: 8080
  datadir: /var/www/html/data

  strategy:
    type: Recreate

  ##
  ## Extra environment variables
  extraEnv:
    - name: INSTALL_PLUGINS
      value: "sociallogin groupfolders"
    - name: ENABLE_PLUGINS
      value: "groupfoldersautomation"
    - name: DISABLE_PLUGINS
      value: "accessibility activity circles comments contactsinteraction dashboard password_policy photos privacy recommendations sharebymail support survey_client systemtags theming updatenotification user_ldap user_status weather_status"
    - name: CONFIG_JSON
      value: '{"system":{"app_install_overwrite":["gluusso","groupfoldersautomation"]},"apps":{"groupfoldersautomation":{"enabled":"yes","installed_version":"0.0.3","types":""},"sociallogin":{"allow_login_connect":"","auto_create_groups":"1","create_disabled_users":"","custom_providers":"{\"custom_oidc\":[{\"name\":\"Schulcloud\",\"title\":\"Schulcloud\",\"authorizeUrl\":\"http:\\/\\/localhost:9000\\/oauth2\\/auth\",\"tokenUrl\":\"http:\\/\\/hydra-host:4444\\/oauth2\\/token\",\"displayNameClaim\":\"name\",\"userInfoUrl\":\"http:\\/\\/hydra-host:4444\\/userinfo\",\"logoutUrl\":\"http:\\/\\/localhost:3100\\/logout\",\"clientId\":\"Nextcloud\",\"clientSecret\":\"Nextcloud\",\"scope\":\"openid offline profile email teams\",\"groupsClaim\":\"teams\",\"style\":\"none\",\"defaultGroup\":\"schulcloud\"}]}","disable_notify_admins":"","disable_registration":"","enabled":"yes","hide_default_login":"","installed_version":"4.15.0","no_prune_user_groups":"","prevent_create_email_exists":"","restrict_users_wo_assigned_groups":"","restrict_users_wo_mapped_groups":"","types":"","update_profile_on_login":"1"}}}'

internalDatabase:
  enabled: false

##
## External database configuration
##
externalDatabase:
  enabled: true
  ## Supported database engines: mysql or postgresql
  type: postgresql
  ## Database host
  host: postgresql.kube.home
  ## Database user
  user: nextcloud
  ## Database password
  password: nextcloud
  ## Database name
  database: nextcloud

###
### PostgreSQL chart configuration
### for more options see https://github.com/bitnami/charts/tree/master/bitnami/postgresql
###
postgresql:
  enabled: true
  global:
    postgresql:
      auth:
        username: nextcloud
        password: nextcloud
        database: nextcloud

service:
  type: ClusterIP
  port: 8080
  loadBalancerIP: nil
  nodePort: nil
